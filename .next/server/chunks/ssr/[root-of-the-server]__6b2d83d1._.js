module.exports=[92759,a=>{"use strict";let b=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},62722,a=>{"use strict";let b=(0,a.i(70106).default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>b],62722)},16201,a=>{"use strict";let b=(0,a.i(70106).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],16201)},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},79861,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},92258,70106,a=>{"use strict";var b=a.i(72131);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],70106);let h=g("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);a.s(["Mail",()=>h],92258)},96221,a=>{"use strict";let b=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],96221)},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},4720,a=>{"use strict";let b=(0,a.i(70106).default)("file-text",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);a.s(["FileText",()=>b],4720)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},5228,a=>{"use strict";var b=a.i(87924),c=a.i(97292),d=a.i(210),e=a.i(60246),f=a.i(92759),g=a.i(4720),h=a.i(96221),i=a.i(16201),j=a.i(62722),k=a.i(38246),l=a.i(72131);function m(){let[a,m]=(0,l.useState)(""),[n,o]=(0,l.useState)(""),[p,q]=(0,l.useState)([]),[r,s]=(0,l.useState)([]),[t,u]=(0,l.useState)([]),[v,w]=(0,l.useState)(""),[x,y]=(0,l.useState)(!1),[z,A]=(0,l.useState)(null),[B,C]=(0,l.useState)(!0);(0,l.useEffect)(()=>{D()},[]);let D=async()=>{try{let[a,b]=await Promise.all([fetch("/api/whatsapp/templates"),fetch("/api/whatsapp/leads")]),c=await a.json(),d=await b.json();q(c.localTemplates||[]),s((d.leads||[]).filter(a=>a.phone))}catch(a){console.error("Error fetching data:",a)}finally{C(!1)}},E=async b=>{if(b.preventDefault(),y(!0),A(null),!p.find(a=>a.id===n)){A({success:!1,message:"Please select a template"}),y(!1);return}let c=[];if(r.filter(a=>t.includes(a.id)&&a.phone).forEach(a=>{c.push({phone:a.phone,name:a.name})}),v&&v.split(/[,\n]/).map(a=>a.trim()).filter(a=>a.length>=10).forEach(a=>{c.some(b=>b.phone.replace(/\D/g,"")===a.replace(/\D/g,""))||c.push({phone:a,name:"Customer"})}),0===c.length){A({success:!1,message:"No recipients selected"}),y(!1);return}try{let b=await fetch("/api/whatsapp/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:a,templateId:n,recipients:c})}),d=await b.json();d.success?(A({success:!0,message:`Campaign created! Sent to ${d.sentCount} recipients.`,sent:d.sentCount}),m(""),o(""),u([]),w("")):A({success:!1,message:d.error||"Failed to create campaign"})}catch{A({success:!1,message:"Failed to connect to server"})}finally{y(!1)}};return B?(0,b.jsx)(c.default,{children:(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,b.jsx)(h.Loader2,{className:"w-8 h-8 animate-spin text-green-600"})})}):(0,b.jsx)(c.default,{children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(k.default,{href:"/admin/whatsapp",className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg hover:bg-gray-100",children:(0,b.jsx)(d.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"New Campaign"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Send bulk WhatsApp messages with variables"})]})]}),z&&(0,b.jsxs)("div",{className:`p-4 rounded-xl flex items-center gap-3 ${z.success?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[z.success?(0,b.jsx)(i.CheckCircle,{className:"w-5 h-5 text-green-600"}):(0,b.jsx)(j.XCircle,{className:"w-5 h-5 text-red-600"}),(0,b.jsx)("span",{className:z.success?"text-green-700":"text-red-700",children:z.message})]}),(0,b.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Campaign Name *"}),(0,b.jsx)("input",{type:"text",value:a,onChange:a=>m(a.target.value),placeholder:"e.g., Seasonal Greetings 2026",required:!0,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(g.FileText,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("h2",{className:"font-semibold text-gray-900",children:"Select Message Template"})]}),0===p.length?(0,b.jsxs)("div",{className:"text-center py-6",children:[(0,b.jsx)(g.FileText,{className:"w-10 h-10 text-gray-300 mx-auto mb-2"}),(0,b.jsx)("p",{className:"text-gray-500",children:"No templates available"}),(0,b.jsx)(k.default,{href:"/admin/whatsapp/templates/new",className:"text-green-600 text-sm font-medium hover:underline",children:"Create a template first"})]}):(0,b.jsx)("div",{className:"grid gap-3",children:p.map(a=>(0,b.jsxs)("label",{className:`flex items-start gap-3 p-4 border rounded-xl cursor-pointer transition-colors ${n===a.id?"border-green-500 bg-green-50 shadow-sm":"border-gray-200 hover:border-gray-300"}`,children:[(0,b.jsx)("input",{type:"radio",name:"template",value:a.id,checked:n===a.id,onChange:a=>o(a.target.value),className:"mt-1"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium text-gray-900",children:a.name}),(0,b.jsx)("p",{className:"text-sm text-gray-500 line-clamp-2 mt-1 font-mono text-xs",children:a.content})]})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,b.jsx)(e.Users,{className:"w-5 h-5 text-green-600"}),(0,b.jsx)("h2",{className:"font-semibold text-gray-900",children:"Select Recipients"})]}),r.length>0&&(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("label",{className:"text-sm font-medium text-gray-700",children:["Qualified Leads (",t.length," selected)"]}),(0,b.jsx)("button",{type:"button",onClick:()=>{t.length===r.length?u([]):u(r.map(a=>a.id))},className:"text-sm text-green-600 font-medium hover:underline",children:t.length===r.length?"Deselect All":"Select All"})]}),(0,b.jsx)("div",{className:"max-h-60 overflow-y-auto border border-gray-200 rounded-xl p-2 space-y-1",children:r.map(a=>(0,b.jsxs)("label",{className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer hover:bg-gray-50 ${t.includes(a.id)?"bg-green-50":""}`,children:[(0,b.jsx)("input",{type:"checkbox",checked:t.includes(a.id),onChange:()=>{var b;return b=a.id,void u(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},className:"rounded h-4 w-4 text-green-600"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-500",children:a.phone})]})]},a.id))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Phone Numbers"}),(0,b.jsx)("textarea",{value:v,onChange:a=>w(a.target.value),placeholder:"Enter phone numbers, one per line or comma-separated",rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 resize-none"}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Total unique recipients: ",t.length+v.split(/[,\n]/).filter(a=>a.trim()).length]}),(0,b.jsx)("p",{className:"text-[10px] text-amber-600 font-medium",children:"* Messages will be sent one by one"})]})]})]}),(0,b.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-4 flex items-start gap-3",children:[(0,b.jsx)(h.Loader2,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5 animate-pulse"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"text-sm font-bold text-amber-800 uppercase tracking-wide",children:"Important Note"}),(0,b.jsx)("p",{className:"text-xs text-amber-700 mt-1",children:"Meta restricts regular messages to a 24-hour window from the user's last message. For older leads, please ensure you use **Meta Approved Templates** for best delivery rates."})]})]}),(0,b.jsx)("button",{type:"submit",disabled:x||!a||!n||0===t.length&&!v,className:"w-full flex items-center justify-center gap-2 py-4 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md active:scale-[0.99]",children:x?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Loader2,{className:"w-5 h-5 animate-spin"}),"Sending Campaign..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Send,{className:"w-5 h-5"}),"Launch Campaign"]})})]})]})})}a.s(["default",()=>m])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6b2d83d1._.js.map
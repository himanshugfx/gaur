{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["file:///D:/Himanshu%20Kumar/Anti%20gravity/gaur/src/lib/prisma.ts"],"sourcesContent":["import { Pool } from 'pg'\r\nimport { PrismaPg } from '@prisma/adapter-pg'\r\nimport { PrismaClient } from '@prisma/client'\r\n\r\nconst globalForPrisma = global as unknown as { prisma: PrismaClient }\r\n\r\nconst connectionString = process.env.DATABASE_URL\r\n\r\nconst pool = new Pool({ connectionString })\r\nconst adapter = new PrismaPg(pool)\r\n\r\nexport const prisma = globalForPrisma.prisma || new PrismaClient({ adapter })\r\n\r\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM;AAEN,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AAEjD,MAAM,OAAO,IAAI,qJAAI,CAAC;IAAE;AAAiB;AACzC,MAAM,UAAU,IAAI,yKAAQ,CAAC;AAEtB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,sMAAY,CAAC;IAAE;AAAQ;AAE3E,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///D:/Himanshu%20Kumar/Anti%20gravity/gaur/src/lib/auth.ts"],"sourcesContent":["\r\nimport { SignJWT, jwtVerify } from 'jose'\r\nimport bcrypt from 'bcryptjs'\r\n\r\nconst SECRET_KEY = new TextEncoder().encode(process.env.JWT_SECRET || 'super-secret-key-change-this')\r\nconst ALG = 'HS256'\r\n\r\nexport async function verifyPassword(password: string, hash: string): Promise<boolean> {\r\n    return bcrypt.compare(password, hash)\r\n}\r\n\r\nexport async function signToken(payload: { id: string; email: string }) {\r\n    return new SignJWT(payload)\r\n        .setProtectedHeader({ alg: ALG })\r\n        .setIssuedAt()\r\n        .setExpirationTime('24h')\r\n        .sign(SECRET_KEY)\r\n}\r\n\r\nexport async function verifyToken(token: string) {\r\n    try {\r\n        const { payload } = await jwtVerify(token, SECRET_KEY, {\r\n            algorithms: [ALG],\r\n        })\r\n        return payload\r\n    } catch (error) {\r\n        return null\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AACA;AAAA;AACA;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AACtE,MAAM,MAAM;AAEL,eAAe,eAAe,QAAgB,EAAE,IAAY;IAC/D,OAAO,8IAAM,CAAC,OAAO,CAAC,UAAU;AACpC;AAEO,eAAe,UAAU,OAAsC;IAClE,OAAO,IAAI,kKAAO,CAAC,SACd,kBAAkB,CAAC;QAAE,KAAK;IAAI,GAC9B,WAAW,GACX,iBAAiB,CAAC,OAClB,IAAI,CAAC;AACd;AAEO,eAAe,YAAY,KAAa;IAC3C,IAAI;QACA,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAA,sKAAS,EAAC,OAAO,YAAY;YACnD,YAAY;gBAAC;aAAI;QACrB;QACA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ"}},
    {"offset": {"line": 125, "column": 0}, "map": {"version":3,"sources":["file:///D:/Himanshu%20Kumar/Anti%20gravity/gaur/src/app/api/admin/login/route.ts"],"sourcesContent":["\r\nimport { NextResponse } from 'next/server'\r\nimport { prisma } from '@/lib/prisma'\r\nimport { verifyPassword, signToken } from '@/lib/auth'\r\nimport { cookies } from 'next/headers'\r\n\r\nexport async function POST(req: Request) {\r\n    try {\r\n        const { email, password } = await req.json()\r\n\r\n        if (!email || !password) {\r\n            return NextResponse.json({ message: 'Missing fields' }, { status: 400 })\r\n        }\r\n\r\n        const admin = await prisma.admin.findUnique({\r\n            where: { email },\r\n        })\r\n\r\n        if (!admin) {\r\n            return NextResponse.json({ message: 'Invalid credentials' }, { status: 401 })\r\n        }\r\n\r\n        const isValid = await verifyPassword(password, admin.passwordHash)\r\n\r\n        if (!isValid) {\r\n            return NextResponse.json({ message: 'Invalid credentials' }, { status: 401 })\r\n        }\r\n\r\n        const token = await signToken({ id: admin.id, email: admin.email })\r\n\r\n        // Await the cookies() promise (Next.js 15+ requirement, good practice for 16 too)\r\n        const cookieStore = await cookies()\r\n\r\n        cookieStore.set('admin_token', token, {\r\n            httpOnly: true,\r\n            secure: process.env.NODE_ENV === 'production',\r\n            sameSite: 'strict',\r\n            maxAge: 60 * 60 * 24, // 24 hours\r\n            path: '/',\r\n        })\r\n\r\n        return NextResponse.json({ success: true })\r\n    } catch (error) {\r\n        console.error('Login error:', error)\r\n        return NextResponse.json({ message: 'Internal server error' }, { status: 500 })\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA;;;;;;;;;AAEO,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE1C,IAAI,CAAC,SAAS,CAAC,UAAU;YACrB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QAC1E;QAEA,MAAM,QAAQ,MAAM,gIAAM,CAAC,KAAK,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE;YAAM;QACnB;QAEA,IAAI,CAAC,OAAO;YACR,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,UAAU,MAAM,IAAA,sIAAc,EAAC,UAAU,MAAM,YAAY;QAEjE,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,MAAM,QAAQ,MAAM,IAAA,iIAAS,EAAC;YAAE,IAAI,MAAM,EAAE;YAAE,OAAO,MAAM,KAAK;QAAC;QAEjE,kFAAkF;QAClF,MAAM,cAAc,MAAM,IAAA,4IAAO;QAEjC,YAAY,GAAG,CAAC,eAAe,OAAO;YAClC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK;YAClB,MAAM;QACV;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAK;IAC7C,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IACjF;AACJ"}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["\r\nimport { NextResponse } from 'next/server'\r\nimport type { NextRequest } from 'next/server'\r\nimport { jwtVerify } from 'jose'\r\n\r\nconst SECRET_KEY = new TextEncoder().encode(process.env.JWT_SECRET || 'super-secret-key-change-this')\r\n\r\nexport async function middleware(request: NextRequest) {\r\n    // Only protect /admin routes\r\n    if (request.nextUrl.pathname.startsWith('/admin')) {\r\n        // Allow access to login page\r\n        if (request.nextUrl.pathname === '/admin/login') {\r\n            return NextResponse.next()\r\n        }\r\n\r\n        const token = request.cookies.get('admin_token')?.value\r\n\r\n        if (!token) {\r\n            return NextResponse.redirect(new URL('/admin/login', request.url))\r\n        }\r\n\r\n        try {\r\n            await jwtVerify(token, SECRET_KEY, {\r\n                algorithms: ['HS256'],\r\n            })\r\n            return NextResponse.next()\r\n        } catch (error) {\r\n            // Token invalid or expired\r\n            return NextResponse.redirect(new URL('/admin/login', request.url))\r\n        }\r\n    }\r\n\r\n    return NextResponse.next()\r\n}\r\n\r\nexport const config = {\r\n    matcher: '/admin/:path*',\r\n}\r\n"],"names":[],"mappings":";;;;;;AACA;AAAA;AAEA;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAE/D,eAAe,WAAW,OAAoB;IACjD,6BAA6B;IAC7B,IAAI,QAAQ,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,WAAW;QAC/C,6BAA6B;QAC7B,IAAI,QAAQ,OAAO,CAAC,QAAQ,KAAK,gBAAgB;YAC7C,OAAO,gMAAY,CAAC,IAAI;QAC5B;QAEA,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,gBAAgB;QAElD,IAAI,CAAC,OAAO;YACR,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,gBAAgB,QAAQ,GAAG;QACpE;QAEA,IAAI;YACA,MAAM,IAAA,4KAAS,EAAC,OAAO,YAAY;gBAC/B,YAAY;oBAAC;iBAAQ;YACzB;YACA,OAAO,gMAAY,CAAC,IAAI;QAC5B,EAAE,OAAO,OAAO;YACZ,2BAA2B;YAC3B,OAAO,gMAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,gBAAgB,QAAQ,GAAG;QACpE;IACJ;IAEA,OAAO,gMAAY,CAAC,IAAI;AAC5B;AAEO,MAAM,SAAS;IAClB,SAAS;AACb"}}]
}